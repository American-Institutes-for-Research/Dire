<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Implements a survey-weighted marginal maximum estimation, a type of
regression where the outcome is a latent trait (such as student ability).
Instead of using an estimate, the likelihood function marginalizes student
ability. Includes a variety of variance estimation strategies."><title>Marginal Maximum Likelihood Estimation of Linear Models — mml • Dire</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Marginal Maximum Likelihood Estimation of Linear Models — mml"><meta property="og:description" content="Implements a survey-weighted marginal maximum estimation, a type of
regression where the outcome is a latent trait (such as student ability).
Instead of using an estimate, the likelihood function marginalizes student
ability. Includes a variety of variance estimation strategies."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Dire</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/MML.html">Marginal Maximum Likelihood Regression Estimation</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/American-Institutes-for-Research/Dire/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Marginal Maximum Likelihood Estimation of Linear Models</h1>
      <small class="dont-index">Source: <a href="https://github.com/American-Institutes-for-Research/Dire/blob/HEAD/R/de.R" class="external-link"><code>R/de.R</code></a></small>
      <div class="d-none name"><code>mml.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements a survey-weighted marginal maximum estimation, a type of
regression where the outcome is a latent trait (such as student ability).
Instead of using an estimate, the likelihood function marginalizes student
ability. Includes a variety of variance estimation strategies.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">mml</span><span class="op">(</span>
  <span class="va">formula</span>,
  <span class="va">stuItems</span>,
  <span class="va">stuDat</span>,
  <span class="va">idVar</span>,
  dichotParamTab <span class="op">=</span> <span class="cn">NULL</span>,
  polyParamTab <span class="op">=</span> <span class="cn">NULL</span>,
  testScale <span class="op">=</span> <span class="cn">NULL</span>,
  Q <span class="op">=</span> <span class="fl">30</span>,
  minNode <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>,
  maxNode <span class="op">=</span> <span class="fl">4</span>,
  polyModel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GPCM"</span>, <span class="st">"GRM"</span><span class="op">)</span>,
  weightVar <span class="op">=</span> <span class="cn">NULL</span>,
  multiCore <span class="op">=</span> <span class="cn">FALSE</span>,
  bobyqaControl <span class="op">=</span> <span class="cn">NULL</span>,
  composite <span class="op">=</span> <span class="cn">TRUE</span>,
  strataVar <span class="op">=</span> <span class="cn">NULL</span>,
  PSUVar <span class="op">=</span> <span class="cn">NULL</span>,
  fast <span class="op">=</span> <span class="cn">TRUE</span>,
  calcCor <span class="op">=</span> <span class="cn">TRUE</span>,
  verbose <span class="op">=</span> <span class="fl">0</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>a <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code>
object in the style of <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code></p></dd>
<dt>stuItems</dt>
<dd><p>a list where each element is named a student ID and contains
a <code>data.frame</code>; see Details for the format</p></dd>
<dt>stuDat</dt>
<dd><p>a <code>data.frame</code> with a single row per student. Predictors in
the <code>formula</code> must be in <code>stuDat</code>.</p></dd>
<dt>idVar</dt>
<dd><p>a variable name on <code>stuDat</code> that is the identifier. Every 
ID from <code>stuDat</code> must appear on <code>stuItems</code> and vice versa.</p></dd>
<dt>dichotParamTab</dt>
<dd><p>a <code>data.frame</code> of dichotomous item information, see Details</p></dd>
<dt>polyParamTab</dt>
<dd><p>a <code>data.frame</code> of polytomous item information, see Details</p></dd>
<dt>testScale</dt>
<dd><p>a <code>data.frame</code> of scaling information, see Details</p></dd>
<dt>Q</dt>
<dd><p>an integer; the number of integration points</p></dd>
<dt>minNode</dt>
<dd><p>a numeric; the smallest integration point for the latent variable</p></dd>
<dt>maxNode</dt>
<dd><p>a numeric; the largest integration point for the latent variable</p></dd>
<dt>polyModel</dt>
<dd><p>polytomous response model;
one of <code>GPCM</code> for the Graded Partial Credit Model
or <code>GRM</code> for the Graded Response Model</p></dd>
<dt>weightVar</dt>
<dd><p>a variable name on <code>stuDat</code> that is the full sample weight</p></dd>
<dt>multiCore</dt>
<dd><p>allows the <code>foreach</code> package to be used. You should
                 have already setup the 
<code><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></code>.</p></dd>
<dt>bobyqaControl</dt>
<dd><p>deprecated. A list that gets passed to <code><a href="https://rdrr.io/pkg/minqa/man/bobyqa.html" class="external-link">bobyqa</a></code></p></dd>
<dt>composite</dt>
<dd><p>a logical indicating if an overall test should be treated as
a composite score; a composite is a weighted average of the
subscales in it.</p></dd>
<dt>strataVar</dt>
<dd><p>character naming a variable on <code>stuDat</code>, the variable indicating the
stratum for each row. Used in post-hoc robust variance estimation.</p></dd>
<dt>PSUVar</dt>
<dd><p>character naming a variable on <code>stuDat</code>; the primary sampling unit
(PSU) variable. Used in post-hoc robust variance estimation. The values
do not need to be unique across strata.</p></dd>
<dt>fast</dt>
<dd><p>a logical indicating if cpp code should be used in <code>mml</code> processes. This should 
yield speed-ups to runs.</p></dd>
<dt>calcCor</dt>
<dd><p>set to <code>TRUE</code> to calculate covariances. Needed to estimate variances and form plausible values</p></dd>
<dt>verbose</dt>
<dd><p>integer, negative or zero for no details, increasingly verbose messages at one and two</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>When called for a single subscale or overall score, returns object of class <code>mmlMeans</code>. 
This is a list with elements:</p><ul><li><p><code>call</code> the call used to generate this <code>mml.means</code> object</p></li>
<li><p><code>coefficients</code> the unscaled marginal maximum likelihood regression coefficients</p></li>
<li><p><code>LogLik</code> the log-likelihood of the fit model</p></li>
<li><p><code>X</code> the design matrix of the marginal maximum likelihood regression</p></li>
<li><p><code>Convergence</code> a convergence note from the optimizer</p></li>
<li><p><code>location</code> used for scaling the estimates</p></li>
<li><p><code>scale</code> used for scaling the estimates</p></li>
<li><p><code>lnlf</code> the log-likelihood function of the unscaled parameters</p></li>
<li><p><code>rr1</code> the density function of each individual, conditional only on item responses in <code>stuItems</code></p></li>
<li><p><code>stuDat</code> the <code>stuDat</code> argument</p></li>
<li><p><code>weightVar</code> the name of the weight variable on <code>stuDat</code></p></li>
<li><p><code>nodes</code> the nodes the likelihood was evaluated on</p></li>
<li><p><code>iterations</code> the number of iterations required to reach convergence</p></li>
<li><p><code>obs</code> the number of observations used</p></li>
<li><p><code>weightedObs</code> the weighted N for the observations</p></li>
<li><p><code>strataVar</code> the column name of the stratum variable on stuDat; potentially used for variance estimation</p></li>
<li><p><code>PSUVar</code> the column name of the PSU variable on stuDat; potentially used for variance estimation</p></li>
<li><p><code>itemScorePoints</code> a data frame that shows item IDs, the number of score points, expected scores (both from the paramTab arguments), as well as the occupied score points</p></li>
<li><p><code>stuItems</code> the data frame passed to <code>mml</code> reformatted for use in mml</p></li>
<li><p><code>formula</code> the formula passed to <code>mml</code></p></li>
<li><p><code>contrasts</code> the contrasts used in forming the design matrix</p></li>
<li><p><code>xlevels</code> the levels of the covariates used in forming the design matrix</p></li>
<li><p><code>polyModel</code> the value of the argument of the same name passed to <code>mml</code></p></li>
<li><p><code>paramTab</code> a data frame that condenses <code>dichotParamTab</code> and <code>polyParamTab</code></p></li>
<li><p><code>fast</code> the value of the argument of the same name passed to <code>mml</code></p></li>
<li><p><code>idVar</code> the value of the argument of the same name passed to <code>mml</code></p></li>
<li><p><code>posteriorEsts</code> the posterior estimates for the people in <code>stuDat</code> included in the model</p></li>
</ul><p>When a composite score is computed there are several subscales run and the return is a <code>mmlCompositeMeans</code>. Many elements are themselves list with one element per construct.
this is a list with elements:</p><ul><li><p><code>call</code> the call used to generate this <code>mml.means</code> object</p></li>
<li><p><code>coefficients</code> matrix of the unscaled marginal maximum likelihood regression coefficients, each row represents a subscale, each column represents a coefficient</p></li>
<li><p><code>X</code> the design matrix of the marginal maximum likelihood regression</p></li>
<li><p><code>rr1</code> a list of elements, each the rr1 object for a subscale (see <code>mmlMeans</code> output)</p></li>
<li><p><code>ids</code> The ID variable used for each row of <code>stuDat</code></p></li>
<li><p><code>Convergence</code> a vector of convergence notes from the optimizer</p></li>
<li><p><code>lnlfl</code> a list of log-likelihood functions of the unscaled parameters, by construct</p></li>
<li><p><code>stuDat</code> a list of <code>stuDat</code> data frames, as used when fitting each construct, filtered to just relevant student records</p></li>
<li><p><code>weightVar</code> the name of the weight variable on <code>stuDat</code></p></li>
<li><p><code>nodes</code> the nodes the likelihood was evaluated on</p></li>
<li><p><code>iterations</code> a vector of the number of iterations required to reach convergence on each construct</p></li>
<li><p><code>obs</code> a vector of the the number of observations used on each construct</p></li>
<li><p><code>testScale</code> the <code>testScale</code> used to scale the data</p></li>
<li><p><code>weightedObs</code> a vector of the weighted N for the observations</p></li>
<li><p><code>SubscaleVC</code> the covariance matrix of subscales. The residuals are assumed to be multivariate normal with this covairiance matrix</p></li>
<li><p><code>idVar</code> the name of the identifier used on <code>stuDat</code> and <code>stuItems</code> data</p></li>
<li><p><code>resl</code> list of mmlMeans objects, one per construct</p></li>
<li><p><code>strataVar</code> the column name of the stratum variable on <code>stuDat</code>; potentially used for variance estimation</p></li>
<li><p><code>PSUVar</code> the column name of the PSU variable on <code>stuDat</code>; potentially used for variance estimation</p></li>
<li><p><code>stuItems</code> the data frame passed to <code>mml</code> reformatted for use in mml</p></li>
<li><p><code>formula</code> the formula passed to <code>mml</code></p></li>
<li><p><code>contrasts</code> the contrasts used in forming the design matrix</p></li>
<li><p><code>xlevels</code> the levels of the covariates used in forming the design matrix</p></li>
<li><p><code>polyModel</code> the value of the argument of the same name passed to <code>mml</code></p></li>
<li><p><code>posteriorEsts</code> the list of posterior estimates for the people in <code>stuDat</code> included in the model</p></li>
<li><p><code>SubscaleVC</code> the matrix of latent correlations across constructs</p></li>
</ul><p><code>LogLik</code> is not returned because there is no likelihood for a composite model.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>mml</code> function models a latent outcome conditioning on
item response data, covariate data, item parameter information,
and scaling information.
These four parts are broken up into at least one argument each.
Student item response data go into <code>stuItems</code>; whereas student
covariates, weights, and sampling information go into <code>stuDat</code>.
The <code>dichotParamTab</code> and <code>polyParamTab</code>
contain item parameter information for dichotomous and polytomous items,
respectively---the item parameter data is the result of an existing
item parameter scaling. In the case of 
the National Assessment of Educational Progress (NAEP),
they can be found online, for example, at
<a href="https://nces.ed.gov/nationsreportcard/tdw/analysis/scaling_irt.aspx" class="external-link">NAEP technical documentation</a>.
Finally, information about scaling and subscale weights for composites are put in <code>testScale</code>.</p>
<p>The model for dichotomous responses data is, by default, three Parameter Logit
(3PL), unless the item parameter information provided by users suggests
otherwise. For example, if the scaling used a two Parameter Logit (2PL) model,
then the guessing parameter can simply be set to zero. For polytomous
responses data, the model is dictated by the <code>polyModel</code> argument.</p>
<p>The <code>dichotParamTab</code> argument is a <code>data.frame</code> with a column named
<code>ItemID</code> that identifies the items and agrees with
the <code>key</code> column in the <code>stuItems</code> argument,
and, for  a 3PL item, columns <code>slope</code>,
<code>difficulty</code>, and <code>guessing</code> for the “a”, “d”, and
“g” parameters, respectively; see the vignette for details of
the 3PL model. Users can also use the column names directly from the
vignette notation (“a”, “d”, and “g”) if they prefer.
Items that are missing (<code>NA</code>) are not used in the likelihood function. 
Users wishing to apply a special behavior for a subset of items can use
set those items to an invalid score and put that in the <code>dichotParamTab</code>
column <code>missingCode</code>. They are then scored as if they are <code>missingValue</code>
proportion correct. To use the guessing parameter for the proportion correct
set <code>missingValue</code> to “c”.</p>
<p>The <code>polyParamTab</code> has columns <code>ItemID</code> that must match with the
<code>key</code> from <code>stuItems</code>, as well as <code>slope</code>
(which can also be called <code>a</code>) that corresponds to the <code>a</code>
parameter in the vignette.
Users must also specify the location of the cut points (\(d_{cj}\) in the vignette)
which are named <code>d1</code>, <code>d2</code>, ..., up to <code>dn</code> where <code>n</code> is
one less than the number of score points. Some people prefer to also apply a 
shift to all of these and this shift is applied when there is a column named
<code>itemLocation</code> by simply adding that to every <code>d*</code> column. Items
are not included in the likelihood for an individual when their value on <code>stuItems</code>
is <code>NA</code>, but no provision is made for guessing, nor special provision for 
missing codes in polytimious items.</p>
<p>For both <code>dichotParamTab</code> and <code>polyParamTab</code> users wishing
to use a <code>D</code> paramter of 1.7 (or any other value) may specify that, per item,
in a column named <code>D</code>.</p>
<p>When there are multiple constructs, subscales, or the user wants a composite
score, additional, optional, columns <code>test</code> and <code>subtest</code> can be used. 
these columns can be numeric or text, they must agree with the same 
columns in <code>testScale</code> to scale the results.</p>
<p>Student data are broken up into two parts. The item response data goes
into <code>stuItems</code>, and the student covariates for the formula go into
<code>stuDat</code>. Information about items, such as item difficulties, is in 
<code>paramTab</code>. All dichotomous items are assumed to be 
3PL, though by setting the guessing parameter to zero, the user
can use a 2PL or the one Parameter Logit (1PL) or Rasch models.
The model for polytomous responses data is dictated by the <code>polyModel</code>
argument.</p>
<p>The marginal maximum likelihood then integrates the product of the student
ability from the assessment data, and the estimate from the linear model
estimates each student's ability based on the <code>formula</code> provided
and a residual standard error term. This integration happens from the
minimum node to the maximum node in the <code>control</code> argument (described
later in this section) with <code>Q</code> quadrature points.</p>
<p>The <code>stuItems</code> argument has the scored student data. It is a list where
each element is named with student ID and contains
a <code>data.frame</code> with at least two columns.
The first required column is named
<code>key</code> and shows the item name as it appears in <code>paramTab</code>;
the second column in named
<code>score</code> and shows the score for that item. For dichotomous
items, the <code>score</code> is 0 or 1. For <code>GPCM</code> items, the scores
start at zero as well. For <code>GRM</code>, the scores start at 1.</p>
<p>For a <code>GPCM</code> model, <code>P0</code> is the “a” parameter, and the other 
columns are the “d” parameters; see the vignette for details
of the GPCM model.</p>
<p>The quadrature points then are a range from <code>minNode</code> to <code>maxNode</code>
with a total of <code>Q</code> nodes.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Harold Doran, Paul Bailey, Claire Kelley, Sun-joo Lee, and Eric Buehler</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://www.air.org/project/nces-data-r-project-edsurvey" class="external-link">EdSurvey</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># 1) make param tab for dichotomous items</span></span>
<span class="r-in"><span class="va">dichotParamTab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ItemID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m109801"</span>, <span class="st">"m020001"</span>, <span class="st">"m111001"</span>,</span>
<span class="r-in">                                        <span class="st">"m046301"</span>, <span class="st">"m046501"</span>, <span class="st">"m051501"</span>,</span>
<span class="r-in">                                        <span class="st">"m111601"</span>, <span class="st">"m111301"</span>, <span class="st">"m111201"</span>,</span>
<span class="r-in">                                        <span class="st">"m110801"</span>, <span class="st">"m110101"</span><span class="op">)</span>,</span>
<span class="r-in">                             test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"composite"</span>,<span class="fl">11</span><span class="op">)</span>,</span>
<span class="r-in">                             subtest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"num"</span>,<span class="fl">6</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"alg"</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">                             slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.96</span>, <span class="fl">0.69</span>, <span class="fl">0.83</span>,</span>
<span class="r-in">                                       <span class="fl">0.99</span>, <span class="fl">1.03</span>, <span class="fl">0.97</span>,</span>
<span class="r-in">                                       <span class="fl">1.45</span>, <span class="fl">0.59</span>, <span class="fl">0.34</span>,</span>
<span class="r-in">                                       <span class="fl">0.18</span>, <span class="fl">1.20</span><span class="op">)</span>,</span>
<span class="r-in">                             difficulty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.37</span>, <span class="op">-</span><span class="fl">0.55</span>,  <span class="fl">0.85</span>,</span>
<span class="r-in">                                            <span class="op">-</span><span class="fl">0.97</span>, <span class="op">-</span><span class="fl">0.14</span>,  <span class="fl">1.21</span>,</span>
<span class="r-in">                                             <span class="fl">0.53</span>, <span class="op">-</span><span class="fl">1.84</span>, <span class="op">-</span><span class="fl">0.46</span>,</span>
<span class="r-in">                                             <span class="fl">2.43</span>,  <span class="fl">0.70</span><span class="op">)</span>,</span>
<span class="r-in">                             guessing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.16</span>, <span class="fl">0.00</span>, <span class="fl">0.17</span>,</span>
<span class="r-in">                                          <span class="fl">0.31</span>, <span class="fl">0.37</span>, <span class="fl">0.18</span>,</span>
<span class="r-in">                                          <span class="fl">0.28</span>, <span class="fl">0.15</span>, <span class="fl">0.09</span>,</span>
<span class="r-in">                                          <span class="fl">0.05</span>, <span class="fl">0.18</span><span class="op">)</span>,</span>
<span class="r-in">                             D <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1.7</span>, <span class="fl">11</span><span class="op">)</span>,</span>
<span class="r-in">                             MODEL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"3pl"</span>, <span class="fl">11</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># param tab for GPCM items</span></span>
<span class="r-in"><span class="va">polyParamTab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ItemID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m0757cl"</span>, <span class="st">"m066501"</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">                           test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"composite"</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span class="r-in">                           subtest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"alg"</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span class="r-in">                           slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.43</span>, <span class="fl">0.52</span><span class="op">)</span>, <span class="co"># could also be called "a"</span></span>
<span class="r-in">                           itemLocation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.21</span>, <span class="op">-</span><span class="fl">0.96</span><span class="op">)</span>, <span class="co"># added to d1 ... dn</span></span>
<span class="r-in">                           d1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.38</span>, <span class="op">-</span><span class="fl">0.56</span><span class="op">)</span>, </span>
<span class="r-in">                           d2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.57</span>, <span class="fl">0.56</span><span class="op">)</span>,</span>
<span class="r-in">                           d3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.18</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span class="r-in">                           D <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.7</span>, <span class="fl">1.7</span><span class="op">)</span>,</span>
<span class="r-in">                           scorePoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4L</span>, <span class="fl">3L</span><span class="op">)</span><span class="op">)</span> <span class="co"># number of score points, read d1 to d(n-1)</span></span>
<span class="r-in"><span class="co"># read-in NAEP Primer data </span></span>
<span class="r-in"><span class="va">sdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EdSurvey/man/readNAEP.html" class="external-link">readNAEP</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/data"</span>, <span class="st">"M36NT2PM.dat"</span>, package <span class="op">=</span> <span class="st">"NAEPprimer"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># read in these items</span></span>
<span class="r-in"><span class="va">items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">dichotParamTab</span><span class="op">$</span><span class="va">ItemID</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">polyParamTab</span><span class="op">$</span><span class="va">ItemID</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># dsex, student sex</span></span>
<span class="r-in"><span class="co"># origwt, full sample weights</span></span>
<span class="r-in"><span class="co"># repgrp1, stratum indicator</span></span>
<span class="r-in"><span class="co"># jkunit, PSU indicator</span></span>
<span class="r-in"><span class="va">edf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EdSurvey/man/getData.html" class="external-link">getData</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">sdf</span>, varnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">items</span>, <span class="st">"dsex"</span>, <span class="st">"origwt"</span>, <span class="st">"repgrp1"</span>, <span class="st">"jkunit"</span>, <span class="st">"sdracem"</span><span class="op">)</span>,</span>
<span class="r-in">               omittedLevels <span class="op">=</span> <span class="cn">FALSE</span>, returnJKreplicates<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># make up a student ID</span></span>
<span class="r-in"><span class="va">edf</span><span class="op">$</span><span class="va">sid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"S"</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">edf</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># apply simplified scoring</span></span>
<span class="r-in"><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">items</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="va">coli</span> <span class="op">&lt;-</span> <span class="va">items</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span class="r-in">  <span class="co"># save the original</span></span>
<span class="r-in">  <span class="va">rawcol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">coli</span>,<span class="st">"raw"</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">edf</span><span class="op">[</span>,<span class="va">rawcol</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">edf</span><span class="op">[</span>,<span class="va">coli</span><span class="op">]</span></span>
<span class="r-in">  <span class="kw">if</span><span class="op">(</span> <span class="va">coli</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">dichotParamTab</span><span class="op">$</span><span class="va">ItemID</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">    <span class="va">edf</span><span class="op">[</span>,<span class="va">coli</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"[ABCDE]"</span>, <span class="va">edf</span><span class="op">[</span>,<span class="va">rawcol</span><span class="op">]</span><span class="op">)</span>, <span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">edf</span><span class="op">[</span>,<span class="va">coli</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"*"</span>, <span class="va">edf</span><span class="op">[</span>,<span class="va">rawcol</span><span class="op">]</span><span class="op">)</span>, <span class="fl">1</span>, <span class="va">edf</span><span class="op">[</span>,<span class="va">coli</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span class="r-in">    <span class="co"># scale for m066501</span></span>
<span class="r-in">    <span class="va">edf</span><span class="op">[</span>,<span class="va">coli</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Incorrect"</span>, <span class="va">edf</span><span class="op">[</span>,<span class="va">rawcol</span><span class="op">]</span><span class="op">)</span>, <span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">edf</span><span class="op">[</span>,<span class="va">coli</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Partial"</span>, <span class="va">edf</span><span class="op">[</span>,<span class="va">rawcol</span><span class="op">]</span><span class="op">)</span>, <span class="fl">1</span>, <span class="va">edf</span><span class="op">[</span>,<span class="va">coli</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">edf</span><span class="op">[</span>,<span class="va">coli</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Correct"</span>, <span class="va">edf</span><span class="op">[</span>,<span class="va">rawcol</span><span class="op">]</span><span class="op">)</span>, <span class="fl">2</span>, <span class="va">edf</span><span class="op">[</span>,<span class="va">coli</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in">    <span class="co"># scale for m0757cl</span></span>
<span class="r-in">    <span class="va">edf</span><span class="op">[</span>,<span class="va">coli</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"None correct"</span>, <span class="va">edf</span><span class="op">[</span>,<span class="va">rawcol</span><span class="op">]</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">edf</span><span class="op">[</span>,<span class="va">coli</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">edf</span><span class="op">[</span>,<span class="va">coli</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"One correct"</span>, <span class="va">edf</span><span class="op">[</span>,<span class="va">rawcol</span><span class="op">]</span><span class="op">)</span>, <span class="fl">1</span>, <span class="va">edf</span><span class="op">[</span>,<span class="va">coli</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">edf</span><span class="op">[</span>,<span class="va">coli</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Two correct"</span>, <span class="va">edf</span><span class="op">[</span>,<span class="va">rawcol</span><span class="op">]</span><span class="op">)</span>, <span class="fl">2</span>, <span class="va">edf</span><span class="op">[</span>,<span class="va">coli</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">edf</span><span class="op">[</span>,<span class="va">coli</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Three correct"</span>, <span class="va">edf</span><span class="op">[</span>,<span class="va">rawcol</span><span class="op">]</span><span class="op">)</span>, <span class="fl">3</span>, <span class="va">edf</span><span class="op">[</span>,<span class="va">coli</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">}</span></span>
<span class="r-in">  <span class="va">edf</span><span class="op">[</span>,<span class="va">rawcol</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span> <span class="co"># delete original</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># stuItems has one row per student/item combination</span></span>
<span class="r-in"><span class="va">stuItems</span> <span class="op">&lt;-</span> <span class="va">edf</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sid"</span>, <span class="va">items</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-in"><span class="va">stuItems</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">stuItems</span>, varying<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">items</span><span class="op">)</span>, idvar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sid"</span><span class="op">)</span>,</span>
<span class="r-in">                    direction<span class="op">=</span><span class="st">"long"</span>, v.names<span class="op">=</span><span class="st">"score"</span>, times<span class="op">=</span><span class="va">items</span>, timevar<span class="op">=</span><span class="st">"key"</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># stuDat is one row per student an contains student-level information</span></span>
<span class="r-in"><span class="va">stuDat</span> <span class="op">&lt;-</span> <span class="va">edf</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sid"</span>, <span class="st">"origwt"</span>, <span class="st">"repgrp1"</span>, <span class="st">"jkunit"</span>, <span class="st">"dsex"</span>, <span class="st">"sdracem"</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># testDat shows scaling and weights for subtests, an overall score can be treated as a subtest</span></span>
<span class="r-in"><span class="va">testDat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>test<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"composite"</span>, <span class="st">"composite"</span><span class="op">)</span> ,</span>
<span class="r-in">                      subtest<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"num"</span>, <span class="st">"alg"</span><span class="op">)</span>,</span>
<span class="r-in">                      location<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">277.1563</span>, <span class="fl">280.2948</span><span class="op">)</span>,</span>
<span class="r-in">                      scale<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">37.7297</span>, <span class="fl">36.3887</span><span class="op">)</span>,</span>
<span class="r-in">                      subtestWeight<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># estimate a regression for Algebra subscale</span></span>
<span class="r-in"><span class="va">mmlA</span> <span class="op">&lt;-</span> <span class="fu">mml</span><span class="op">(</span><span class="va">alg</span> <span class="op">~</span> <span class="va">dsex</span>,</span>
<span class="r-in">            stuItems<span class="op">=</span><span class="va">stuItems</span>, stuDat<span class="op">=</span><span class="va">stuDat</span>,</span>
<span class="r-in">            dichotParamTab<span class="op">=</span><span class="va">dichotParamTab</span>, polyParamTab<span class="op">=</span><span class="va">polyParamTab</span>,</span>
<span class="r-in">            testScale<span class="op">=</span><span class="va">testDat</span>,</span>
<span class="r-in">            idVar<span class="op">=</span><span class="st">"sid"</span>, weightVar<span class="op">=</span><span class="st">"origwt"</span>, <span class="co"># these are column names on stuDat</span></span>
<span class="r-in">            strataVar<span class="op">=</span><span class="st">"repgrp1"</span>, PSUVar<span class="op">=</span><span class="st">"jkunit"</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># summary, with Taylor standard errors</span></span>
<span class="r-in"><span class="va">mmlAs</span> <span class="op">&lt;-</span> <span class="fu">summary.mmlMeans</span><span class="op">(</span><span class="va">mmlA</span>, varType<span class="op">=</span><span class="st">"Taylor"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># estimate a regression for Numeracy subscale</span></span>
<span class="r-in"><span class="va">mmlN</span> <span class="op">&lt;-</span> <span class="fu">mml</span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="va">dsex</span>,</span>
<span class="r-in">            stuItems<span class="op">=</span><span class="va">stuItems</span>, stuDat<span class="op">=</span><span class="va">stuDat</span>,</span>
<span class="r-in">            dichotParamTab<span class="op">=</span><span class="va">dichotParamTab</span>, polyParamTab<span class="op">=</span><span class="va">polyParamTab</span>,</span>
<span class="r-in">            testScale<span class="op">=</span><span class="va">testDat</span>,</span>
<span class="r-in">            idVar<span class="op">=</span><span class="st">"sid"</span>, weightVar<span class="op">=</span><span class="st">"origwt"</span>, <span class="co"># these are column names on stuDat</span></span>
<span class="r-in">            strataVar<span class="op">=</span><span class="st">"repgrp1"</span>, PSUVar<span class="op">=</span><span class="st">"jkunit"</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># summary, with Taylor standard errors</span></span>
<span class="r-in"><span class="va">mmlNs</span> <span class="op">&lt;-</span> <span class="fu">summary.mmlMeans</span><span class="op">(</span><span class="va">mmlN</span>, varType<span class="op">=</span><span class="st">"Taylor"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mmlNs</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># draw plausible values for mmlA</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pvd</span> <span class="op">&lt;-</span> <span class="fu"><a href="drawPVs.html">drawPVs.mmlMeans</a></span><span class="op">(</span><span class="va">mmlA</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># alternative specification</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pvs</span> <span class="op">&lt;-</span> <span class="fu"><a href="drawPVs.html">drawPVs.mmlMeans</a></span><span class="op">(</span><span class="fu">summary.mmlMeans</span><span class="op">(</span><span class="va">mmlA</span>, varType<span class="op">=</span><span class="st">"Taylor"</span><span class="op">)</span>, stochasticBeta<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># composite regression </span></span>
<span class="r-in"><span class="va">mmlC</span> <span class="op">&lt;-</span> <span class="fu">mml</span><span class="op">(</span><span class="va">composite</span> <span class="op">~</span> <span class="va">dsex</span> ,</span>
<span class="r-in">            stuItems<span class="op">=</span><span class="va">stuItems</span>, stuDat<span class="op">=</span><span class="va">stuDat</span>,</span>
<span class="r-in">            dichotParamTab<span class="op">=</span><span class="va">dichotParamTab</span>, polyParamTab<span class="op">=</span><span class="va">polyParamTab</span>,</span>
<span class="r-in">            testScale<span class="op">=</span><span class="va">testDat</span>,</span>
<span class="r-in">            idVar<span class="op">=</span><span class="st">"sid"</span>, weightVar<span class="op">=</span><span class="st">"origwt"</span>, <span class="co"># these are column names on stuDat</span></span>
<span class="r-in">            strataVar<span class="op">=</span><span class="st">"repgrp1"</span>, PSUVar<span class="op">=</span><span class="st">"jkunit"</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># summary, with Taylor standard errors</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mmlC</span>, varType<span class="op">=</span><span class="st">"Taylor"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># draw plausible values for mmlC</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pvd</span> <span class="op">&lt;-</span> <span class="fu"><a href="drawPVs.html">drawPVs.mmlCompositeMeans</a></span><span class="op">(</span><span class="va">mmlC</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># alternative specification </span></span>
<span class="r-in"><span class="va">mmlCsum</span> <span class="op">&lt;-</span> <span class="fu">summary.mmlCompositeMeans</span><span class="op">(</span><span class="va">mmlC</span>, varType<span class="op">=</span><span class="st">"Taylor"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pvs</span> <span class="op">&lt;-</span> <span class="fu"><a href="drawPVs.html">drawPVs.mmlCompositeMeans</a></span><span class="op">(</span><span class="va">mmlCsum</span>, stochasticBeta<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Paul Bailey, Eric Buehler, Sun-joo Lee, Harold Doran.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

